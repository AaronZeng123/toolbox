<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF 工具 - 实用工具集合</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/pdf-processor.css">
    <!-- 引入 PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
    <!-- 添加 pdf-lib 库 -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <!-- 添加 JSZip 库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- 添加 docx 库 -->
    <script src="https://unpkg.com/docx@8.2.3/build/index.min.js"></script>
    <!-- 添加 mammoth.js 库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
</head>
<body>
    <header>
        <h1>PDF 工具</h1>
    </header>
    
    <main>
        <div class="tool-container">
            <!-- 文件上传区域 -->
            <div class="upload-section">
                <div class="input-header">
                    <label>PDF 文件：</label>
                    <button id="clearFileBtn" class="clear-btn">清除</button>
                </div>
                <input type="file" id="pdfInput" accept=".pdf" hidden>
                <div class="upload-area" id="dropZone">
                    <!-- 未上传状态 -->
                    <div class="upload-content" id="uploadContent">
                        <div class="upload-icon">📄</div>
                        <p>拖拽 PDF 文件到这里或点击上传</p>
                        <button class="upload-btn">选择文件</button>
                    </div>
                    <!-- 预览状态 -->
                    <div class="preview-content" id="previewContent" style="display: none;">
                        <div class="file-info">
                            <div class="file-icon">📄</div>
                            <div class="file-details">
                                <div class="file-name" id="fileName">文件名称</div>
                                <div class="file-meta" id="fileMeta">页数：0页 | 大小：0MB</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 功能按钮区域 -->
            <div class="actions-section">
                <button id="convertWordBtn" class="action-btn">转Word</button>
                <button id="convertImageBtn" class="action-btn">转图片</button>
                <button id="splitPdfBtn" class="action-btn">拆分PDF</button>
                <button id="compressPdfBtn" class="action-btn">压缩PDF</button>
                <button id="watermarkBtn" class="action-btn">加水印</button>
                <button id="deletePageBtn" class="action-btn">删除页面</button>
            </div>

            <!-- 功能区域 -->
            <div class="function-sections">
                <!-- 转Word功能区 -->
                <div id="convertWordSection" class="function-section">
                    <div class="input-group">
                        <button id="startConvertWordBtn" class="action-btn" disabled>开始转换</button>
                    </div>
                    <div class="hint">提示：转换可能需要一些时间，请耐心等待</div>
                </div>

                <!-- 转图片功能区 -->
                <div id="convertImageSection" class="function-section">
                    <div class="input-group">
                        <select id="imageFormatSelect">
                            <option value="png">PNG</option>
                            <option value="jpeg">JPEG</option>
                        </select>
                        <select id="imageQualitySelect">
                            <option value="high">高质量</option>
                            <option value="medium">中等质量</option>
                            <option value="low">低质量</option>
                        </select>
                        <button id="startConvertImageBtn" class="action-btn" disabled>开始转换</button>
                    </div>
                </div>

                <!-- 拆分功能区 -->
                <div id="splitSection" class="function-section">
                    <div class="input-group">
                        <input type="text" id="pageRangeInput" placeholder="例如: 1-3,5,7-9">
                        <button id="startSplitBtn" class="action-btn" disabled>开始拆分</button>
                    </div>
                    <div class="hint">提示：用逗号分隔不同范围，用连字符表示页面范围</div>
                </div>

                <!-- 压缩功能区 -->
                <div id="compressSection" class="function-section">
                    <div class="input-group">
                        <select id="targetSizeSelect">
                            <option value="1">压缩到1-2M</option>
                            <option value="2">压缩到2-5M</option>
                            <option value="5">压缩到5-10M</option>
                            <option value="10">压缩到10M以上</option>
                        </select>
                        <button id="startCompressBtn" class="action-btn" disabled>开始压缩</button>
                    </div>
                    <div class="hint">提示：压缩比例越大，图片质量损失越多</div>
                </div>

                <!-- 水印功能区 -->
                <div id="watermarkSection" class="function-section">
                    <div class="input-group">
                        <input type="text" id="watermarkText" placeholder="输入水印文字">
                        <select id="watermarkColor">
                            <option value="#CCCCCC">浅灰色</option>
                            <option value="#999999">深灰色</option>
                            <option value="#000000">黑色</option>
                            <option value="#FF0000">红色</option>
                        </select>
                        <select id="watermarkSize">
                            <option value="small">小</option>
                            <option value="medium" selected>中</option>
                            <option value="large">大</option>
                        </select>
                        <select id="watermarkRotation">
                            <option value="0">不旋转</option>
                            <option value="45" selected>45度</option>
                            <option value="-45">-45度</option>
                        </select>
                        <select id="watermarkOpacity">
                            <option value="0.1">10%透明度</option>
                            <option value="0.2" selected>20%透明度</option>
                            <option value="0.3">30%透明度</option>
                            <option value="0.5">50%透明度</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <select id="watermarkDensity">
                            <option value="sparse">稀疏</option>
                            <option value="medium" selected>适中</option>
                            <option value="dense">密集</option>
                        </select>
                        <select id="watermarkPosition">
                            <option value="center" selected>居中</option>
                            <option value="tile">平铺</option>
                            <option value="custom">自定义位置</option>
                        </select>
                        <button id="startWatermarkBtn" class="action-btn" disabled>添加水印</button>
                    </div>
                    <div class="hint">提示：水印透明度越低越不明显，建议选择20%左右</div>
                </div>

                <!-- 删除页面功能区 -->
                <div id="deletePageSection" class="function-section">
                    <div class="input-group">
                        <input type="text" id="deletePageInput" placeholder="例如: 1,3,5-7">
                        <button id="startDeleteBtn" class="action-btn" disabled>开始删除</button>
                    </div>
                    <div class="hint">提示：用逗号分隔页码，用连字符表示页码范围</div>
                </div>


            </div>
        </div>
    </main>

    <div id="toast" class="toast"></div>

    <script src="../js/modules/pdf-processor.js"></script>
</body>
</html>